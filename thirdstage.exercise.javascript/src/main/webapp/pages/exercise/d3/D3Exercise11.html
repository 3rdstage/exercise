<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>D3.js Exercise</title>
<script type="text/javascript" src="../../../scripts/jquery/js/jquery-1.8.0.min.js"></script>
<script type='text/javascript' src='../../../scripts/d3/d3.min.js'></script>


	<style type="text/css">
		div .axis path, div .axis line{
			fill:none;
			stroke:black;
			shape-rendering:crispEdges;
		}
		
		div .axis text{
			font-family:sans-serif;
			font-size:11px;
		}
	</style>
</head>
<body>

	<h3>Simple transition</h3>
	<div id="chart1"></div>


	<script>
	d3.select("#chart1").append("svg")
		.attr("width", 800)
		.attr("height", 400)
		.style("margin", "10px")
		.style("padding", "20px");
	
	var xScale = d3.scale.linear().domain([0, 800]).range([20, 780]);
	var yScale = d3.scale.linear().domain([0, 400]).range([380, 20]);
	var xAxis = d3.svg.axis().scale(xScale).orient("bottom");
	var yAxis = d3.svg.axis().scale(yScale).orient("left");
	
	d3.select("#chart1").select("svg").append("g")
		.classed("axis", true)
		.attr("transform", "translate(0, 380)")
		.call(xAxis)
	
	
	d3.select("#chart1").select("svg").append("g")
		.classed("axis", true)
		.attr("transform", "translate(20, 0)")
		.call(yAxis);
	
	var positions = [[200, 100], [400, 200]]; 
	
	d3.select("#chart1").select("svg").selectAll("circle")
		.data(positions)
		.enter()
		.append("circle")
		.attr("cx", function(d){ return xScale(d[0]);})
		.attr("cy", function(d){ return yScale(d[1]);})
		.attr("r", 20);                                                  
		
	d3.select("#chart1").select("svg").selectAll("circle")
		.attr("fill", "green")
		.transition()
		.attr("fill", "red");
	</script>
	
	<hr/>
	
	<div id="chart2" style="margin-left:20px">
		
		<div id="controls2" style="margin-top:10px">
			<button id="control2a" type="button">Remove right half</button>
		</div>	
		
	</div>
	
	<script>
	var dimensions2 = [800, 400];
	var offsets2 = [40, 40];
	var ranges2 = [[offsets2[0], dimensions2[0] - offsets2[0]]
		, [offsets2[1], dimensions2[1] - offsets2[1]]]
	var domains2 = [[0, 400], [0, 300]]; //min x : domains[0][0], max x : domains[0][1]
	var r2 = 3;
	
	var data2 = [];

	
	//create scales
	var xScale2 = d3.scale.linear().domain(domains2[0]).range(ranges2[0]);
	var yScale2 = d3.scale.linear().domain(domains2[1]).range(ranges2[1].reverse());
	
	//create panel
	d3.select("#chart2").insert("svg", "div")
		.attr("width", dimensions2[0])
		.attr("height", dimensions2[1])
		.style("background-color", "lightgray")
	
	//create axis
	var xAxis2 = d3.svg.axis().scale(xScale2).orient("bottom");
	var yAxis2 = d3.svg.axis().scale(yScale2).orient("left");
	
	d3.select("#chart2 svg").append("g")
		.classed("axis", true)
		.attr("transform", "translate(0, " + (dimensions2[1] - offsets2[1]) + ")")
		.call(xAxis2);
	
	d3.select("#chart2 svg").append("g")
		.classed("axis", true)
		.attr("transform", "translate(" + offsets2[0] + ", 0)")
		.call(yAxis2);

	var circles = d3.select("#chart2 > svg").selectAll("circle")
			.data(data2);

	function init2(){
		data2 = [];
		for(var i = 10; i < domains2[0][1]; i = i + 10){
			data2.push([i, Math.round(Math.random()*50)]);
		}		
		
			
		circles.exit().remove();
		circles.enter().append("circle")
			.attr("cx", function(d){ return xScale2(d[0]);})
			.attr("cy", function(d){ return yScale2(d[1]);})
			.attr("r", r2);
	}
	
	init2();
	
	$("#control2a").click(function(ev){
		ev.stopPropagation();
		
		//remove data that is located right half region
		var m = (domains2[0][1] - domains2[0][0])/2
		for(var i = data2.length - 1; i > -1; i--){
			if(data2[i][0] > m) data2.splice(i, 1);
		}
		
		circles.exit().remove();
	});
	
	
	
	</script>
	
	
	


</body>
</html>