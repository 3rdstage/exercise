<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SVG Editor Prototype</title>
<link rel="stylesheet" media="screen" href="../../../styles/bootstrap/bootstrap.min.css">
</head>
<body style="margin-left:40px">
	
	
<svg id='panel1' style="width:800px;height:400px;border:1px solid blue">
</svg>
<br/>
<div id='pallette1' class='btn-group'>
	<button id='addCircleButton' type='button' class='btn btn-default'>Circle</button>
	<button id='addRectangle' type='button' class='btn btn-default'>Rectangle</button>
</div>

<div id='srcView1' style="width:800px;height:400px;border:1px dotted gray">

<script src="../../../scripts/jquery/js/jquery-1.8.0.min.js"></script>
<script src="../../../scripts/bootstrap/bootstrap.min.js"></script>
<script src="../../../scripts/svg.js/svg.min.js"></script>
<script src="../../../scripts/svg.js/svg.draggable.js"></script>
<script>

SVG.extend(SVG.Doc, {

	isConnecting : function(){
		if(arguments.length === 0){
			if(this.connecting === undefined){
				this.connecting = false;
			}
			return this.connecting;
		}else{
			this.connecting = arguments[0];
			return this;
		}
	},
	
	startAnchor : function(){
		if(arguments.length === 0){
			if(this.connecting === undefined){
			}
		}
	}

});


SVG.AnchorableRect = SVG.invent({
	
	create : 'g',
	
	inherit: SVG.G,
	
	construct: {
		anchorable: function(width, height, r){
			var g = new SVG.AnchorableRect;
			var rect = (new SVG.Rect).size(width, height);
			var anchors = [];
			var anchor;
			var fromAnchor;
			var isConnecting;
			var i = 0, n;
			var z; //final object to return

			rect.fill('white').stroke('black');
			g.add(rect);
			
			//create anchors and glue them to group
			//basically 8 anchors for every 45 dgree of angle from the right north.
			anchors[i++] = (new SVG.Ellipse).radius(r).center(width/2, 0);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(width, 0);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(width, height/2);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(width, height);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(width/2, height);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(0, height);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(0, height/2);
			anchors[i++] = (new SVG.Ellipse).radius(r).center(0, 0);
			
			n  = anchors.length;
			for(i = 0; i < n; i++){
				anchor = anchors[i];
				anchor.fill('white').stroke('darkgray');
				g.add(anchor);
				//anchor.hide();
				anchor.mouseover(function(){
					this.visible(true);
				});
				anchor.mouseout(function(){
					this.visible(false);
				});
				
				anchor.click(function(){
					this.doc().isConnecting(true);
				});
			}

			z = this.put(g);	
			z.draggable();
			return z;			
		}
	}
	
});

var draw = SVG('panel1');
var rect = draw.anchorable(50, 30, 5).center(200, 200);

</script>
</body>
</html>