<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

   <bean id="securityConstraint" class="org.eclipse.jetty.util.security.Constraint">
      <property name="name" value="BASIC" />
      <property name="roles" value="user,admin" />
      <!-- set authenticate=false to disable login -->
      <property name="authenticate" value="false" />
   </bean>
   <bean id="adminSecurityConstraint" class="org.eclipse.jetty.util.security.Constraint">
      <property name="name" value="BASIC" />
      <property name="roles" value="admin" />
      <!-- set authenticate=false to disable login -->
      <property name="authenticate" value="false" />
   </bean>
   <bean id="securityConstraintMapping" class="org.eclipse.jetty.security.ConstraintMapping">
      <property name="constraint" ref="securityConstraint" />
      <property name="pathSpec" value="/api/*,/admin/*,*.jsp" />
   </bean>
   <bean id="adminSecurityConstraintMapping" class="org.eclipse.jetty.security.ConstraintMapping">
      <property name="constraint" ref="adminSecurityConstraint" />
      <property name="pathSpec" value="*.action" />
   </bean>
   <bean id="rewriteHandler" class="org.eclipse.jetty.rewrite.handler.RewriteHandler">
      <property name="rules">
         <list>
            <bean id="header" class="org.eclipse.jetty.rewrite.handler.HeaderPatternRule">
               <property name="pattern" value="*" />
               <property name="name" value="X-FRAME-OPTIONS" />
               <property name="value" value="SAMEORIGIN" />
            </bean>
         </list>
      </property>
   </bean>

   <bean id="contexts" class="org.eclipse.jetty.server.handler.ContextHandlerCollection">
   </bean>

   <bean id="jettyPort" class="org.apache.activemq.web.WebConsolePort" init-method="start">
      <!-- the default port number for the web console -->
      <property name="host" value="0.0.0.0" />
      <property name="port" value="8161" />
   </bean>

   <bean id="Server" depends-on="jettyPort" class="org.eclipse.jetty.server.Server" destroy-method="stop">

      <property name="handler">
         <bean id="handlers" class="org.eclipse.jetty.server.handler.HandlerCollection">
            <property name="handlers">
               <list>
                  <ref bean="contexts" />
               </list>
            </property>
         </bean>
      </property>

   </bean>

   <bean id="invokeConnectors" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
      <property name="targetObject" ref="Server" />
      <property name="targetMethod" value="setConnectors" />
      <property name="arguments">
         <list>
            <bean id="Connector" class="org.eclipse.jetty.server.ServerConnector">
               <constructor-arg ref="Server" />
               <!-- see the jettyPort bean -->
               <property name="host" value="#{systemProperties['jetty.host']}" />
               <property name="port" value="#{systemProperties['jetty.port']}" />
            </bean>
            <!-- Enable this connector if you wish to use https with web console -->
            <!-- bean id="SecureConnector" class="org.eclipse.jetty.server.ServerConnector"> <constructor-arg ref="Server" /> <constructor-arg> <bean id="handlers"
               class="org.eclipse.jetty.util.ssl.SslContextFactory"> <property name="keyStorePath" value="${activemq.conf}/broker.ks" /> <property name="keyStorePassword" value="password"
               /> </bean> </constructor-arg> <property name="port" value="8162" /> </bean -->
         </list>
      </property>
   </bean>

   <bean id="configureJetty" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
      <property name="staticMethod" value="org.apache.activemq.web.config.JspConfigurer.configureJetty" />
      <property name="arguments">
         <list>
            <ref bean="Server" />
         </list>
      </property>
   </bean>

   <bean id="invokeStart" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean" depends-on="configureJetty, invokeConnectors">
      <property name="targetObject" ref="Server" />
      <property name="targetMethod" value="start" />
   </bean>





</beans>